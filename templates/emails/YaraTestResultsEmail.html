{% load static %}

<h3>Scan Summary</h3>
<table>
  <thead>
    <tr>
      <th>Folder Name</th>
      <th>Number of Files Scanned</th>
      <th>Number of Rules in Set</th>
      <th>Number of Rule Matches</th>
      <th>Folder Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>{{ folder_name }}</td>
      <td>{{ file_count }}</td>
      <td>{{ rule_count }}</td>
      <td>{{ matches | length }}</td>
      <td>{{ folder_description }}</td>
    </tr>
  </tbody>
</table>

{% if externals %}
  <h3>External variables</h3>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Value</th>
      </tr>
    </thead>
    <tbody>
    {% for key, value in externals.items %}
      <tr>
        <td>{{ key }}</td>
        <td>{{ value }}</td>
      </tr>
    {% endfor %}
    </tbody>
  </table>
{% else %}
  <h3>No external variables specified</h3>
{% endif %}

{% if matches %}
  {% for rulename, filenames in matches.items %}
    <h3>Matches for {{ rulename }}</h3>
    {% for filename in filenames %}
      {{ filename }}<br>
    {% endfor %}
  {% endfor %}
{% else %}
  <h3>There were no rule matches</h3>
{% endif %}
